<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">
<head>
    <meta charset="utf-8" />
  <meta name="generator" content="pandoc-markdown-css-theme" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<meta name="author" content="Jake Zimmerman">
<meta name="dcterms.date" content="2024-10-09 17:17:13 -0400">
<meta name="description" content="The other day I learned that Instruments.app can record file system activity on macOS!">
<title>Approximating strace with Instruments.app – Jake Zimmerman</title>

  <link rel="stylesheet" href="/assets/css/theme.css">
<link rel="stylesheet" href="/assets/css/skylighting-solarized-theme.css">




  
    <link rel="apple-touch-icon-precomposed" href="/assets/img/touch-icon.png">
  
    <link rel="icon" sizes="32x32" href="/assets/img/favicon@2x.png">
  
    <link rel="icon" sizes="16x16" href="/assets/img/favicon.png">
  
    <link rel="alternate" type="application/atom+xml" href="/atom.xml">
  
    <link rel="stylesheet" href="/assets/css/extra.css">
  




</head>
<body>
  




  <header>
    <h1 class="title">Approximating strace with Instruments.app</h1>
    <blockquote class="metadata">
    <p class="date before-toc"><time datetime="2024-10-09 17:17:13 -0400">October 9, 2024</time></p>
    </blockquote>
  </header>


  <nav id="TOC" role="doc-toc">
  <a href="/">Home</a><br>
  <strong>Contents</strong><label for="contents">⊕</label>
  <input type="checkbox" id="contents">
  <ul>
  <li><a href="#strace-is-great-but"
  id="toc-strace-is-great-but"><code>strace</code> is great,
  but…</a></li>
  <li><a href="#instruments.app-can-trace-arbitrary-programs"
  id="toc-instruments.app-can-trace-arbitrary-programs">Instruments.app
  can trace arbitrary programs!</a></li>
  </ul>
</nav>

<main>
<p>The other day I learned that Instruments.app can record file system
activity on macOS!</p>
<figure>
<img src="/assets/img/instruments-app-strace.png"
alt="Instruments.app on macOS tracing git status" />
<figcaption aria-hidden="true">Instruments.app on macOS tracing
<code>git status</code></figcaption>
</figure>
<h2 id="strace-is-great-but"><code>strace</code> is great, but…</h2>
<p>One of the things I <em>always</em> use <code>strace</code> on Linux
for is tracing a process to see, for example, which global config files
it’s reading—it’s so simple, just</p>
<pre><code>strace -- git status 2&gt; trace.log</code></pre>
<p>and then look through the logs to see where it’s looking for files.
For example, I discovered that <code>git</code> installed via Homebrew
reads out of <code>/home/linuxbrew/.linuxbrew/etc/gitconfig</code>
instead of <code>/etc/gitconfig</code> this way!</p>
<p>I’m sure you know how frustrating it is to think your program works
one way when it’s actually doing something else entirely…
<code>strace</code> makes it easy to figure out when your program works
a different way without having to traipse through the program’s source
code.</p>
<p>… but since macOS shipped <a
href="https://en.wikipedia.org/wiki/System_Integrity_Protection">System
Integrity Protection</a>, I haven’t been able to get the macOS
alternatives like <code>dtrace</code> or <code>dtruss</code> to
work.</p>
<h2 id="instruments.app-can-trace-arbitrary-programs">Instruments.app
can trace arbitrary programs!</h2>
<p>Using the “Filesystem Activity” instrument in Instruments.app, I can
run a program and see all the file system activity the program does!</p>
<p>There is also a “System Call Trace” instrument, but unlike
<code>strace</code> it doesn’t seem to record arguments and return
values of syscalls—only the File System activity records arguments and
return values for file system syscalls. So it’s not a complete
alternative to <code>strace</code> but at least it’s better than trying
to figure out how to work around System Integrity Protection.</p>
<p><br />
</p>
<p>While I was searching the internet trying to figure out whether
Instruments.app could trace file system activity, I also stumbled on
this great post:</p>
<p>→ <a
href="https://registerspill.thorstenball.com/p/did-you-know-about-instruments">Did
you know about Instruments?</a></p>
<p>It’s full of more great tips!</p>
</main>


    <footer class="signoff">
      <p>
        More like this:
        
          <span class="smallcaps"><strong><a href="/categories/#debugging">debugging</a></strong></span>, 
        
          <span class="smallcaps"><strong><a href="/categories/#linux">linux</a></strong></span>, 
        
          <span class="smallcaps"><strong><a href="/categories/#osx">osx</a></strong></span>
        
      </p>
      <p><a href="/">← Return home</a></p>
    </footer>
  
    <script src="/assets/js/enable_checkboxes.js"></script>

  



</body>
</html>

