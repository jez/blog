<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">
<head>
    <meta charset="utf-8" />
  <meta name="generator" content="pandoc-markdown-css-theme" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<meta name="author" content="Jake Zimmerman">
<meta name="dcterms.date" content="2018-02-06 02:07:37 -0500">
<meta name="description" content="It's really cool how composition works with lenses!
">
<title>Lenses & Composition â€“ Jake Zimmerman</title>

  <link rel="stylesheet" href="/assets/css/theme.css">
<link rel="stylesheet" href="/assets/css/skylighting-solarized-theme.css">




  
    <link rel="apple-touch-icon-precomposed" href="/assets/img/touch-icon.png">
  
    <link rel="icon" sizes="32x32" href="/assets/img/favicon@2x.png">
  
    <link rel="icon" sizes="16x16" href="/assets/img/favicon.png">
  
    <link rel="alternate" type="application/atom+xml" href="/atom.xml">
  
    <link rel="stylesheet" href="/assets/css/extra.css">
  




</head>
<body>
  




  <header>
    <h1 class="title">Lenses & Composition</h1>
    <blockquote class="metadata">
    <p class="date before-toc"><time datetime="2018-02-06 02:07:37 -0500">February 6, 2018</time></p>
    </blockquote>
  </header>


  <nav id="TOC" role="doc-toc">
  <a href="/">â† Return home</a><br>
</nav>

<main>
<p>
</p>
<!-- more -->
<p>A lens is really just a function <code>a -&gt; b</code> that we represent backwards<span class="sidenote-wrapper"><label for="sn-0" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-0" class="margin-toggle"/><span class="sidenote">Iâ€™m exaggerating a bit here ğŸ˜… To see what I <em>really</em> mean, see <a href="/lens-intuition">this post</a>.<br />
<br />
</span></span> and with an extra <code>Functor f</code> parameter lying around:</p>
<pre><code>type Lens&#39; a b = Functor f =&gt; (b -&gt; f b) -&gt; (a -&gt; f a)</code></pre>
<p><strong>What does this mean for function composition?</strong></p>
<!-- more -->
<p>Normal function composition looks like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ot">(.) ::</span> (b <span class="ot">-&gt;</span> c) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> c)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ot">f ::</span> a <span class="ot">-&gt;</span> b</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ot">g ::</span> b <span class="ot">-&gt;</span> c</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>g <span class="op">.</span><span class="ot"> f ::</span> (a <span class="ot">-&gt;</span> c)</span></code></pre></div>
<p>We often have to read code that looks like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">.</span> f <span class="op">$</span> x</span></code></pre></div>
<p>This means â€œstart with <code>x</code>, then run <code>f</code> on it, and run <code>g</code> after that.â€ This sentence reads opposite from how the code reads!</p>
<p>What about for lenses? Here we have <code>f'</code> and <code>g'</code> which behave similarly in some sense to <code>f</code> and <code>g</code> from before:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ot">f&#39; ::</span> <span class="dt">Functor</span> f <span class="ot">=&gt;</span> (b <span class="ot">-&gt;</span> f b) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> f a)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">--  â‰ˆ a -&gt; b</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ot">g&#39; ::</span> <span class="dt">Functor</span> f <span class="ot">=&gt;</span> (c <span class="ot">-&gt;</span> f c) <span class="ot">-&gt;</span> (b <span class="ot">-&gt;</span> f b)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">--  â‰ˆ b -&gt; c</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>f&#39; <span class="op">.</span><span class="ot"> g&#39; ::</span> <span class="dt">Functor</span> f <span class="ot">=&gt;</span> (c <span class="ot">-&gt;</span> f c) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> f a)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">--       â‰ˆ a -&gt; c</span></span></code></pre></div>
<p>In the lens world, <code>^.</code> behaves kind of like a flipped <code>$</code> that turns lenses into getters, which lets us write code like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">^.</span> f&#39; <span class="op">.</span> g&#39;</span></code></pre></div>
<p>This means â€œstart with <code>x</code>, then get <code>f'</code> from it, then get <code>g'</code> after that.â€ The sentence reads just like the code!</p>
<p>This is pretty cool, because it means that lenses (which are â€œfunctionalâ€ getters) read almost exactly like property access (which are â€œimperativeâ€ getters). Same concise syntax, but with an elegant semantics.</p>
<!-- vim:tw=72
-->
</main>


    <footer class="signoff">
      <p>
        More like this:
        
          <span class="smallcaps"><strong><a href="/categories/#haskell">haskell</a></strong></span>, 
        
          <span class="smallcaps"><strong><a href="/categories/#types">types</a></strong></span>, 
        
          <span class="smallcaps"><strong><a href="/categories/#fragment">fragment</a></strong></span>
        
      </p>
      <p><a href="/">â† Return home</a></p>
    </footer>
  
    <script src="/assets/js/enable_checkboxes.js"></script>

  



</body>
</html>

